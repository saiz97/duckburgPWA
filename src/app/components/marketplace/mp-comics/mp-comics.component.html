<h1>Comics</h1>

<div class="filter-container">
  <div class="row">
    <mat-form-field appearance="fill">
      <mat-label>Choose a type</mat-label>
      <mat-select [(value)]="selectedType">
        <mat-option value="">All Types</mat-option>
        <mat-option [value]="type" *ngFor="let type of filterOptions.types">{{type}}</mat-option>
      </mat-select>
    </mat-form-field>
<!--
    <mat-form-field appearance="fill">
      <mat-label>Choose a year</mat-label>
      <mat-select [(value)]="selectedYear">
        <mat-option value="">All Years</mat-option>
        <mat-option [value]="year" *ngFor="let year of filterOptions.years">{{year}}</mat-option>
      </mat-select>
    </mat-form-field>
-->

    <mat-form-field class="example-form-field">
      <mat-label>Price from:</mat-label>
      <input matInput type="number" [min]="filterOptions.minPrice" [max]="filterOptions.maxPrice" [(ngModel)]="fromVal">
      <button *ngIf="fromVal" matSuffix mat-icon-button aria-label="Clear" (click)="fromVal=filterOptions.minPrice">
        <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>

    <mat-form-field class="example-form-field">
      <mat-label>Price to:</mat-label>
      <input matInput type="number" [min]="filterOptions.minPrice" [max]="filterOptions.maxPrice" [(ngModel)]="toVal">
      <button *ngIf="toVal" matSuffix mat-icon-button aria-label="Clear" (click)="toVal=filterOptions.maxPrice">
        <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>

    <button matSuffix mat-icon-button aria-label="Clear" (click)="loadFiltered()">
      <mat-icon>filter_alt</mat-icon> Apply filters
    </button>
    <button matSuffix mat-icon-button aria-label="Clear" (click)="loadUnfiltered()">
      <mat-icon>replay</mat-icon> Clear filters
    </button>
  </div>

  <div class="row">
    <mat-button-toggle-group #group="matButtonToggleGroup" (change)="changePage(group.value)" *ngIf="comics.size > 1">
      <mat-button-toggle [value]="c.key" *ngFor="let c of comics | keyvalue" [class.mat-button-toggle-checked] = "c.key == currentPage">
        {{c.key}}
      </mat-button-toggle>
    </mat-button-toggle-group>
  </div>
</div>

<app-loader *ngIf="isLoading;else cardcontainer"></app-loader>

<ng-template #cardcontainer>
  <div class="card-container" *ngIf="checkDataForPageExists();else nodata">
    <a routerLink="item/{{c.id}}" [state]="{ data: c, type: 'comic' }" class="card-link" *ngFor="let c of displayedComics()">
      <mat-card class="card comic">
        <img mat-card-image [src]="c.image" alt="Image of {{c.title}}">
        <mat-card-actions>
          <h3><mat-icon>euro</mat-icon> {{c.price}}</h3>
          <button><mat-icon>shopping_cart</mat-icon></button>
        </mat-card-actions>
      </mat-card>
    </a>
  </div>
</ng-template>

<ng-template #nodata>
  <h3>No data for this page.</h3>
</ng-template>
